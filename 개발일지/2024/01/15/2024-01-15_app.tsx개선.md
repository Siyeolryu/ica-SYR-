# 개발일지: _app.tsx 개선

## 작성시각
2024년 1월 15일

## 해결하고자 한 문제
`_app.tsx` 파일에 에러 처리가 없고, 메타데이터도 없어서 문제가 생겼을 때 사용자가 알 수 없었어요. 또한 모든 페이지에 Layout이 강제로 적용되어서 나중에 Layout이 필요 없는 페이지를 만들기 어려웠어요.

## 해결된 것

### 1. 에러 처리 기능 추가
- **ErrorFallback 컴포넌트**: 에러가 발생하면 예쁜 에러 화면을 보여줘요
- **전역 에러 핸들러**: JavaScript 에러와 Promise 에러를 잡아서 처리해요
- **다시 시도 버튼**: 에러가 나면 "다시 시도" 버튼을 눌러서 페이지를 새로고침할 수 있어요

### 2. 메타데이터 추가
- **페이지 제목**: 브라우저 탭에 보이는 제목을 설정했어요
- **설명**: 검색 엔진이 이해할 수 있도록 설명을 추가했어요
- **뷰포트**: 모바일에서 잘 보이도록 설정했어요
- **테마 색상**: 브라우저 주소창 색상을 다크 테마로 맞췄어요

### 3. Layout 선택적 적용
- **noLayout 옵션**: 페이지에서 `noLayout = true`를 설정하면 Layout 없이 표시할 수 있어요
- 나중에 로그인 페이지나 특별한 페이지를 만들 때 유용해요

### 4. 코드 정리
- 불필요한 빈 줄 제거
- 타입 안전성 개선

## 해결되지 않은 것

### 1. TypeScript 타입 오류
- 린터에서 타입 오류가 나지만, 실제로는 실행에는 문제가 없어요
- `npm install`을 다시 실행하면 해결될 수 있어요

### 2. 더 강력한 에러 처리
- React Error Boundary를 사용하면 더 강력한 에러 처리가 가능해요
- 하지만 클래스 컴포넌트가 필요해서 지금은 사용하지 않았어요

### 3. 에러 로깅 서비스 연동
- 에러가 발생했을 때 서버에 자동으로 보내는 기능이 없어요
- 나중에 Sentry 같은 서비스를 연결하면 좋아요

### 4. 로딩 상태
- 페이지가 로딩 중일 때 보여줄 인디케이터가 없어요

## 향후 개발을 위한 컨텍스트

### 추가된 기능

**1. 에러 처리**
```typescript
// 에러가 발생하면 ErrorFallback 컴포넌트를 보여줌
if (error) {
  return <ErrorFallback error={error} resetError={...} />;
}
```

**2. 메타데이터**
```typescript
<Head>
  <title>당신이 잠든 사이 - 미국 주식 데일리 브리핑</title>
  <meta name="description" content="..." />
</Head>
```

**3. Layout 선택적 적용**
```typescript
// 페이지에서 이렇게 설정하면 Layout 없이 표시됨
export default function LoginPage() {
  return <div>로그인</div>;
}
LoginPage.noLayout = true;
```

### 사용 방법

**Layout 없이 페이지 만들기:**
```typescript
// pages/login.tsx
export default function Login() {
  return <div>로그인 페이지</div>;
}
Login.noLayout = true; // Layout 없이 표시
```

### 다음 단계

1. **에러 로깅 서비스 연동** (선택)
   - Sentry나 다른 에러 추적 서비스 연결
   - 에러 발생 시 자동으로 알림 받기

2. **로딩 인디케이터**
   - 페이지 전환 시 로딩 표시
   - 사용자 경험 개선

3. **성능 최적화**
   - React.memo 사용
   - 불필요한 리렌더링 방지

### 참고사항

- 에러 핸들러는 `useEffect`에서 설정되고, 컴포넌트가 사라질 때 정리돼요
- `window.addEventListener`를 사용해서 전역 에러를 잡아요
- 에러가 발생하면 콘솔에 로그를 남기고, 사용자에게는 친절한 메시지를 보여줘요

### 쉽게 설명하면

`_app.tsx`를 개선한 것은 마치 "집에 경비 시스템을 설치한 것"과 같아요.
- **에러 처리**: 문제가 생기면 경비 시스템이 알려주고, 사용자에게 안내해요
- **메타데이터**: 집 주소와 설명을 정리해서 다른 사람이 찾기 쉽게 해요
- **Layout 선택**: 필요에 따라 방(페이지)마다 다른 인테리어를 할 수 있어요

이제 에러가 발생해도 사용자가 알 수 있고, 문제를 해결할 수 있어요!










